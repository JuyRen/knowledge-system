> 浏览器接收到服务器返回的数据时，会进行页面渲染

浏览器将渲染过程划分为很多个子阶段（`构建 DOM 树、样式计算、布局阶段、分层、绘制、分块、光栅化和合成`），每个子阶段都有三大步骤：

1. 开始阶段，接收到内容
2. 处理阶段，处理内容
3. 输出阶段，输出内容

## 构建 DOM 树

> HTML 是给人看的，DOM 树结构是给机器看的，中间需要转化

1. 开始阶段：接收到 HTML 内容
2. 处理阶段：HTML 解析器解析内容
3. 输出阶段：DOM 树结构, `document`（保存内存中，可以通过 JS 操作 document）

## 样式计算

> CSS 是给人看的，document.styleSheets 是给浏览器看的，中间需要转化。 转化过程即样式计算

1. 开始阶段：接收到 css 内容，数据来源

   - 内联样式
   - link 引入
   - style 写法

2. 处理阶段：将 CSS 语法，转换成`document.styleSheets`

   - 将样式标准化, css 元素写法多样，但最终需要转换成浏览器能解析的标准语法
     ![css标准化](https://static001.geekbang.org/resource/image/12/60/1252c6d3c1a51714606daa6bdad3a560.png)

   - 计算`每个元素`的样式

     - 继承规则
     - 层叠规则

3. 输出阶段：将计算好的样式，保存在每个元素的 `computedStyle`

## 布局

> 通过 DOM 树，和 DOM 元素的样式，计算生成`布局树`，用来在浏览器上显示

1. 开始阶段：接受 DOM 树和 DOM 元素样式
2. 处理阶段：`display: none`的元素不生成树， `head标签`里的元素不生成树
3. 输出阶段：一颗`布局树`
